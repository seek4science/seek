<%= stylesheet_link_tag 'spreadsheet_explorer' -%>
<%= javascript_include_tag 'spreadsheet_explorer' %>

<div id="spreadsheet-explorer">
  <div id="spreadsheet_errors"></div>

  <input size="10" id="selection_data">
  <input size="60" id="cell_info" readonly="readonly">

  <div class="spreadsheet_controls">
    <%= link_to image('spreadsheet_export') + " Export Data", "#", :onclick =>"copy_cells(); return false;",
          :title => "Export selected cells into an external application", :class => "spreadsheet_button requires_selection" %>
  </div>
  
  <div class="spreadsheet_viewer" id="spreadsheet_outer_frame">
    <%= render :partial => "spreadsheets/export", :locals => {:resource => resource } %>


        <%
           spreadsheet = Rails.cache.fetch(resource.content_blob.cache_key) do
             resource.spreadsheet
           end
        %>
        <%= render :partial => "spreadsheets/spreadsheet_styles", :locals => {:styles => spreadsheet.styles} %>
        <%= render :partial => "spreadsheets/spreadsheet", :locals => {:workbook => spreadsheet }%>

  </div>
</div>
