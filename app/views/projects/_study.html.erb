    <div class="simpleForm">
        <ul class="nav nav-tabs">
            <li class="active "><a data-toggle="tab" href="#details"><i class="glyphicon glyphicon-th-list"></i>
                    Details</a></li>
            <li><a data-toggle="tab" href="#design"><i class="glyphicon glyphicon-pencil"></i> Design</a></li>
            <li><a data-toggle="tab" href="#workflow" onclick="setTimeout(() => { 
                        //LOAD WORKFLOW
                    }, 250);"><i class="glyphicon glyphicon-random"></i> Workflow</a></li>
        </ul>
        <div class="tab-content">
            <div id="details" class="tab-pane fade in active" style="padding:10px">
                <p id="title"><strong style="text-align: center;">Title:</strong> <span
                        id="studytitleContent"></span></p>
                <p id="description"> <strong>Description:</strong> <span id="StudyDescriptionContent"></span> </p>
                <p><strong>Hypothesis: </strong> <span id="Hypothesis"></span></p>
                <p><strong>Experimentalists: </strong> <span id="experimentalists"></span></p>
                <div class="form-group">
                    <label>The following people...</label>
                    <%= objects_input('study-permission-people-ids', [], typeahead: { values: Person.all.map { |p| { id: p.id, name: p.name, hint: p.typeahead_hint } } }, name: nil) -%>
                    <p class="help-block">Start typing a person's name and select from the list that appears. You can
                        select
                        multiple people.</p>
                </div>
                <div class="form-group">
                    <label>can...</label>
                    <%= select_tag('permission-people-access-type', policy_selection_options(nil, nil, Policy::ACCESSIBLE), name: nil, class: 'form-control') -%>
                </div>

                <input type="submit" id="study_permission_submit_btn" value="Update" class="btn btn-primary">
            </div>
            <div id="design" class="tab-pane fade" style="padding:10px">
                <%=  render partial: 'study_design' %>
            </div>
            <div id="workflow" class="tab-pane fade" style="padding:10px">
                <%=  render partial: 'workflow' %>
            </div>
        </div>
    </div>

    <script>
        // Add a person permission to the table
        $j('#study_permission_submit_btn').on('click', e => {
            let people = $j('#study-permission-people-ids').tagsinput('items');
            let pid = <%= params[:id] %>
            // let url = pid + '/update_study_permission';
            let std_id = $j("#selected_item_id").val()
            if (!std_id) return
            let url = `/studies/${std_id}`;
            let data = {
               "data": {
                   "type": "studies",
                   "id": std_id,
                   "attributes": {
                       "policy": {
                           "access": "download",
                           "permissions": []
                       }
                   }
               }
           }
             people.forEach(function (person, index) {
               data.data.attributes.policy.permissions.push({
                   'resource': {
                       'id': person.id,
                       'type': 'people'
                   },
                   'access': get_permission(parseInt($j('#permission-people-access-type')
                   .val()))
               })
           });
           
             $j.ajax({
               method: 'PATCH',
               "headers": {
                   "Content-Type": "application/json",
                   "Accept": "application/json"
               },
               url,
               data: JSON.stringify(data),
               success: s => {
                   alert('Sharing policy updated successfully!')
               },
               error: (e) => {
                   alert('error!')
               }
           })
        });
    </script>